# ASP.NET 4.5 高级控件

- 列表服务器控件
    - ListBox控件
        - AutoPostBack属性：获取或设定是否回传
        - DataSource属性：获取或设置对象，数据绑定控件从该对象中检索其数据项列表
        - DataTextField属性：获取或设置为列表项提供文本内容的数据源字段
        - DataValueField属性：获取或设置为各列表项提供值的数据源字段
        - Items集合：与列表中的每项对应，基本属性：
            - Text：每个选项的文本
            - Value：每个选项的值
            - Selected：选项的状态，True表示默认选中
        - Rows属性：获取或设置ListBox中显示的行数
        - SelectedIndex属性：获取或设置列表中选定项的最低序号索引
        - SelectedItem属性：获取列表控件中索引最小的选定项
        - SelectedValue属性：获取列表控件中的选定项的值，或选择列表控件中包含指定项的值
        - SelectionMode属性：指定控件的行为模式
            - Single：单选
            - Multiple：多选
        - Count属性：表示列表项中条目的总数
        - Selected属性：表示某个项被选中
        - ClearSelected方法：取消选择ListBox中的所有项
        - GetSelected方法：返回一个值，指示是否选择了指定的项
        - Sort方法：对ListBox中的项进行排序
    - DropDownList控件
        - AutoPostBack属性：获取或设定是否回传
        - DataSource属性：获取或设置对象，数据绑定控件从该对象中检索其数据项列表
        - DataTextField属性：获取或设置为列表项提供文本内容的数据源字段
        - DataValueField属性：获取或设置为各列表项提供值的数据源字段
        - Items集合：与列表中的每项对应，基本属性：
            - Text：每个选项的文本
            - Value：每个选项的值
            - Selected：选项的状态，True表示默认选中
        - SelectedIndex属性：获取或设置列表中选定项的最低序号索引
        - SelectedItem属性：获取列表控件中索引最小的选定项
        - SelectedValue属性：获取列表控件中的选定项的值，或选择列表控件中包含指定项的值
        - BorderColor属性：边框颜色
        - BorderStyle属性
        - BorderWidth属性
    - BulletedList控件：有序或无序列表
        - DataSource属性：获取或设置对象，数据绑定控件从该对象中检索其数据项列表
        - DataTextField属性：获取或设置为列表项提供文本内容的数据源字段
        - DataValueField属性：获取或设置为各列表项提供值的数据源字段
        - Items集合：与列表中的每项对应，基本属性：
            - Text：每个选项的文本
            - Value：每个选项的值
            - Selected：选项的状态，True表示默认选中
        - BulletStyle属性：获取或设置控件的项目符号样式
            - NotSet：未设置符号样式
            - Numbered：数字符号样式
            - LowerAlpha：小写字母符号样式
            - UpperAlpha：大写字母符号样式
            - LowerRoman：小写罗马数字符号样式
            - UpperRoman：大写罗马数字符号样式
            - Disc：实心圆符号样式
            - Circle：圆圈符号样式
            - Square：实心正方形符号样式
            - CustomImage：自定义图像符号样式
        - DisplayMode属性：获取或设置列表内容的显示模式
            - Text：显示为文本
            - HyperLink：显示为超链接
            - LinkButton：显示为链接按钮
        - Click事件：单击链接按钮时发生
        - SelectedIndexChanged事件：选定项改变时发生
- 容器服务器控件
    - Panel控件
        - BackImageUrl属性：获取或设置面板控件背景图像的URL
        - DefaultButton属性：规定Panel中默认按钮的ID
        - Direction属性：规定panel的内容显示方向
        - GroupingText属性：规定panel中控件组的标题
        - ScrollBars属性：规定Panel中滚动栏的位置和可见性
        - BackColor属性：获取或设置背景色
        - HorizontalAlign属性：获取或设置面板内容的水平对齐方式
        - Wrap属性：获取或设置面板内容是否换行
        - Visible属性：获取或设置是否可见
        - Attributes属性：获取与控件的属性不对应的任何特性的集合
        - Controls属性：获取ControlCollection对象，该对象表示UI层次结构中指定服务器控件的子控件
        - DataBinding事件：当服务器控件绑定到数据源时发生
    - MultiView控件：是View控件的容器，一次只能显示一个View控件
        - ActiveViewIndex属性：决定哪个View控件显示，从0开始
        - EnableTheming属性：获取或设置是否向MultiView控件应用主题
        - Views属性：获取控件中View控件的集合
        - Visible属性：设置默认状态下控件是否可见
        - AddParsedSubObject：通知MultiView控件已分析了一个XML或HTML元素，并将该元素添加到MultiView控件的ViewCollection集合中
        - CreatedControlCollection：创建ControlCollection已保存MultiView控件的子控件
        - GetActiveView：返回MultiView控件的当前活动的View控件
        - LoadControlState：加载MultiView控件的当前状态
        - SetActiveView：将指定的View控件设置为MultiView控件的活动视图
        - SaveControlState：保存MultiView控件的当前状态
        - RemoveControl：在将View控件从MultiView控件的Controls集合中移除后调用
        - OnBubbleEvent：确定MultiView控件的事件是否传递给页的用户界面服务器控件层次结构
        - ViewCollection：获得包含在MultiView中的View对象集合
        - OnActiveViewChanged事件：引发MultiView控件的ActiveViewChanged事件
        - Command字段：当有CommandName属性的控件设置为以下几个命令名时，将不需要额外的代码实现视图导航
            - NextView：导航到下一个View
            - PrevView：导航到上一个View
            - SwitchViewByID：导航到指定ID的View，用CommandArgument指定ID值
            - SwitchViewByIndex：导航到指定索引的View，用CommandArgument指定索引
    - PlaceHolder控件：动态加载其他控件，使各页面包含相同元素
        - Controls：获取ControlCollection对象，该对象表示UI层次结构中指定服务器控件的子控件
            - Add方法
        - Visible：获取或设置一个值，该值指示服务器控件是否作为UI呈现在页上
        - ViewState：获取状态信息的字典，这些信息可以保证在同一页的多个请求间保存和还原服务器控件的视图状态
        - Site：获取容器信息，该容器再呈现于设计图面上时承载当前控件
        - DesignMode：获取一个值，该值指示是否正在使用设计图面上的一个控件
        - ClientID：获取由ASP.NET生成的服务器空间标识符
        - AddedControl：在子控件添加到Control对象的Controls集合后调用
        - CreateChildControls：由ASP.NET页面框架调用，以通知使用基于合成的实现的服务器控件创建它们包含的任何子控件，以便为回发或呈现做准备
        - HasControls：确定服务器控件是否包含任何子控件
- 验证控件
    - 六种验证控件
        验证类型	使用的控件	控件的作用
        必需项	RequiredFieldValidator	验证某个控件的内容是否被改变
        与某值的比较	CompareValidator	用于对两个值进行比较验证
        范围检查	RangeValidator	用于验证某个值是否在要求的范围之内
        模式匹配	RegularExpressionValidator	用于验证相关输入控件的值是否匹配正则表达式指定的模式
        验证汇总	ValidationSummary	不执行验证，但与其他验证控件一起用于显示来自页面上所有验证控件的错误信息
        自定义	CustomValidator	调用在服务器端编写的自定义验证函数
    - RequireFieldValidator控件
        - 在链接到的控件失去焦点时，如果其初始属性值没有被改变，将会触发RequiredFieldValidator控件（用户名不能为空）
        - ControlToValidate属性：通过设置该属性为某控件的ID，来把验证控件绑定到需要验证的控件
        - ErrorMessage属性：通过设置该属性来设置当验证控件无效时需要显示的信息
        - ValidationGroup属性：绑定到验证程序所属的组
        - Text属性：当验证控件无效时显示的验证程序的文本
        - Display属性：通过设置该属性控制验证控件的显示模式，有三个值：
            - None：表示验证控件无效时不显示信息
            - Static：表示验证控件在页面上占位是静态的，不能为其它控件所占
            - Dynamic：表示验证控件在页面上占位是动态的，可以为其他控件所占，当验证失效时验证控件才占据页面位置
    - CompareValidator控件
        - 将用户的值与控件的值进行比较
        - ControlToValidate属性：通过设置该属性为某控件的ID，来把验证控件绑定到需要验证的控件
        - ErrorMessage属性：通过设置该属性来设置当控件无效时需要显示的消息
        - ValidationGroup属性：绑定到验证程序所属的组
        - Text属性：当验证控件无效时显示的验证程序的文本
        - Display属性：通过设置该属性控制验证控件的显示模式，有三个值：
            - None：表示验证控件无效时不显示信息
            - Static：表示验证控件在页面上占位是静态的，不能为其它控件所占
            - Dynamic：表示验证控件在页面上占位是动态的，可以为其他控件所占，当验证失效时验证控件才占据页面位置
        - Operator属性：通过设置该属性来设置比较时所用到的运算符，有以下几种：
            - Equal：所验证的输入控件的值与其他控件的值或常数值之间的相等比较
            - NotEqual：所验证的输入控件的值与其他控件的值或常数值之间的不相等比较
            - GreaterThan：所验证的输入控件的值与其他控件的值或常数值之间的大于比较
            - GreaterThanEqual：所验证的输入控件的值与其他控件的值或常数值之间的大于或等于比较
            - LessThan：所验证的输入控件的值与其他控件的值或常数值之间的小于比较
            - LessThanEqual：所验证的输入控件的值与其他控件的值或常数值之间的小于或等于比较
            - DataTypeCheck：所验证的输入控件的值与BaseCompareValidator.Type属性所指定的数据类型之间的数据结构比较
        - Type属性：通过该属性来设置按照哪种数据类型来进行比较，常用的数据类型包括：
            - String：字符串数据类型
            - Integer：32位有符号整数数据类型
            - Double：双精度浮点数数据类型
            - Date：日期数据类型
            - Currency：一种可以包含货币符号的十进制数据类型
        - ValueToCompare：设置用来做比较的数据
        - ControlToCompare：设置用来做比较的控件，有时需要让验证控件控制的控件的数据和其他控件里的数据做比较时就会用到这个属性
    - RangeValidator控件：验证值是否在指定范围
        - ControlToValidate属性：通过设置该属性为某控件的ID，来把验证控件绑定到需要验证的控件
        - ErrorMessage属性：通过设置该属性来设置当控件无效时需要显示的消息
        - ValidationGroup属性：绑定到验证程序所属的组
        - Text属性：当验证控件无效时显示的验证程序的文本
        - Display属性：通过设置该属性控制验证控件的显示模式，有三个值：
            - None：表示验证控件无效时不显示信息
            - Static：表示验证控件在页面上占位是静态的，不能为其它控件所占
            - Dynamic：表示验证控件在页面上占位是动态的，可以为其他控件所占，当验证失效时验证控件才占据页面位置
        - Type属性：通过该属性来设置按照哪种数据类型来进行比较，常用的数据类型包括：
            - String：字符串数据类型
            - Integer：32位有符号整数数据类型
            - Double：双精度浮点数数据类型
            - Date：日期数据类型
            - Currency：一种可以包含货币符号的十进制数据类型
        - MaximumValue：设置用来做比较的数据范围上限
        - MinimumValue：设置用来做比较的数据范围下限
    - RegularExpressionValidator控件：验证值是否匹配正则表达式
        - ControlToValidate属性：通过设置该属性为某控件的ID，来把验证控件绑定到需要验证的控件
        - ErrorMessage属性：通过设置该属性来设置当控件无效时需要显示的消息
        - ValidationGroup属性：绑定到验证程序所属的组
        - Text属性：当验证控件无效时显示的验证程序的文本
        - Display属性：通过设置该属性控制验证控件的显示模式，有三个值：
            - None：表示验证控件无效时不显示信息
            - Static：表示验证控件在页面上占位是静态的，不能为其它控件所占
            - Dynamic：表示验证控件在页面上占位是动态的，可以为其他控件所占，当验证失效时验证控件才占据页面位置
        - ValidationExpression属性：通过设置该属性来设置利用正则表达式描述的预定义格式
    - CustomValidator控件：将自己的验证函数绑定到控件
        - ControlToValidate属性：通过设置该属性为某控件的ID，来把验证控件绑定到需要验证的控件
        - ErrorMessage属性：通过设置该属性来设置当控件无效时需要显示的消息
        - ValidationGroup属性：绑定到验证程序所属的组
        - Text属性：当验证控件无效时显示的验证程序的文本
        - Display属性：通过设置该属性控制验证控件的显示模式，有三个值：
            - None：表示验证控件无效时不显示信息
            - Static：表示验证控件在页面上占位是静态的，不能为其它控件所占
            - Dynamic：表示验证控件在页面上占位是动态的，可以为其他控件所占，当验证失效时验证控件才占据页面位置
        - IsValid属性：获取或设置一个值来判断是否通过验证，true表示通过验证，false表示没通过验证
        - ValidationExpression属性：通过该属性来判断绑定的控件为空时是否执行验证
            - true：为空时执行验证
            - false：为空时不执行验证
        - OnServerValidate事件：服务器验证函数
    - ValidationSummary控件：显示页面中所有验证错误信息的摘要
        - HeaderText属性：验证摘要页的标题部分显示的文本
        - ShowMessage属性：指明是否显示该控件，true表示显示
        - ShowMessageBox属性：指定是否显示一个消息对话框显示验证的摘要信息，true表示显示消息对话框
        - ValidationGroup属性：用于指定验证控件所属的验证组的名称
        - DisplayMode属性：通过该属性设置验证摘要的显示模式，有以下值：
            - BulletList：默认的显示模式，每个消息都显示为单独的项
            - List：每个消息显示在单独的行中
            - SingleParagraph：每个消息显示为段落中的一个句子
- 用户控件
    - 一个用户控件就是一个简单的 .ascx 页面，可以被另外一个 .NET 页面包含进去，实现代码复用
    - 用户控件没有@Page指令，只有@Control指令，不能作为独立文件运行
    - 在文件资源管理器中添加用户控件，将其拖拽到指定位置即可
- 其他常用高级控件
    - Calendar控件：单月份年历，查看和选择日期
        - 功能
            - 显示日历，显示月份、月份之前的一周、月份之后的一周
            - 允许用户选择日、周、月
            - 允许用户选择一定范围内的日期
            - 允许用户移到下一月或上一月
            - 以编程的方式控制选定日期的显示
            - 自定义日历外观
        - 属性
            - DayNameFormat：获取或设置“周”中各天的名称格式，其值是一个名为DayNameFormat的枚举类型，该枚举类型的值包括FirstLetter、FirstTowLetter、Short、Full、Shortest
            - FirstDayOfWeek：获取或设置要在控件的“第一天”列中显示的一周中的某天。可以设置为Default、Sunday、Monday、Tuesday、Wednesday、Thursday、Friday、Saturday
            - NextMonthText：获取或设置为下一个月导航控件显示的文本。ShowNextPreMonth属性必须设置为true，并且NextPreMonth属性设置为CustomText时才有效
            - NextPrevFormat：获取或设置控件的标题部分中下个月和上个月导航元素的格式。可以设置为ShortMonth、FullMonth及默认值CustomText
            - SelectedDate：获取或设置选定的日期，默认为程序执行的日期
            - SelectedDates：获取System.DateTime对象的集合，这些对象表示控件上的选定日期
            - SelectionMode：获取或设置控件上的日期选择格式。可设置值为Day（用户只可以选中某一天为默认值）、None（用户不能选取日期，只能显示日期）、DayWeek（用户可以一次选取整个星期或者某一天）、DayWeekMonth（用户可以一次选取这个月、整个星期或者某一天）。
            - SelectionMonthText：获取或设置为选择器列中的月份选择元素显示的文本。要将SelectionMode属性设置为DayWeekMonth时才有效
            - SelectionWeekText：获取或设置为选择器列中的周选择元素显示的文本。要将SelectionMode属性设置为DayWeekMonth才有效
            - ShowDayHeader：获取或设置一个值，该值指示是否显示一周中各天的标头。有true和false选项
            - ShowGridLines：获取或设置一个值，该值指示是否用网格线分割控件上的日期
            - ShowNextPrevMonth：获取或设置一个值，该值指示控件是否在标题部分显示下个月和上个月导航元素
            - ShowTitle：获取或设置一个值，该值指示是否选择标题部分
            - TitleFormat：获取或设置标题部分的格式，可以设置为默认值MonthYear或Month
            - TodaysDate：获取或设置当天日期的值
            - VisibleDate：获取或设置指定要在控件上显示的月份的日期
        - 方法和事件
            - AddDays：返回与指定DateTime相距指定天数的DateTime
            - AddMonth：返回与指定DateTime相距指定月数的DateTime
            - AddWeeks：返回与指定DateTime相距指定周数的DateTime
            - AddYears：返回与指定DateTime相距指定年数的DateTime
            - GetDayOfMonth：返回指定DateTime中的日期是该月的几号
            - GetDayOfWeek：返回指定DateTime中的日期是星期几
            - GetDayOfYear：返回指定DateTime中的日期是该年中的第几天
            - GetDaysInMonth：返回指定月份中的天数
            - GetDaysInYear：返回指定年份中的天数
            - GetLeapMonth：计算指定年份或指定纪元年份的闰月
            - GetMonth：返回指定DateTime中的月份
            - GetMonthsInYear：返回指定年份中的月数
            - GetWeekOfYear：返回年中包括指定DateTime中日期的星期
            - GetYear：返回指定DateTime中的年份
            - IsLeapMonth：确定某月是否为闰月
            - IsLeapYear：确定某年是否为闰年
            - ToDateTime：返回设置为指定日期和时间的DateTime
            - SelectionChanged事件：当用户选取日期时发生
            - DayRender事件：控件每产生一个日期就会触发该事件
                - if(e.day.IsWeekend){e.Day.IsSelected = false} //禁止选择周末
            - VisibleMonthChanged：当用户单击日历控件标题上的“上个月”或“下个月”按钮时触发
    - AdRotator控件
        - 显示广告的方式：
            - 随机显示广告
            - 对广告设置优先级别以使某些广告有更多的显示频率
            - 编写循环逻辑以显示广告
        - 数据源：
            - XML
            - Database
        - 属性：
            - AdvertisementFile：获取或设置包含广告信息的XML文件的路径
            - AlternateTextField：获取或设置一个自定义数据字段，使用它代替广告的AlternateText属性
            - Font：获取与广告控件关联的字体属性
            - ImageUrlField：获取或设置一个自定义数据字段，使用它代替广告的ImageUrl属性
            - KeywordFIlter：获取或设置类别关键字以筛选出XML文件中特定类型的公布
            - NavigateUrlField：获取或设置一个自定义数据字段，使用它代替广告的NavigateUrl属性
            - TagKey：获取控件的HTML标记，该属性是受保护的
            - Target：获取或设置当单击控件时，显示所链接到的页面内容的浏览器窗口或框架名称
            - UniqueID：获取控件在层次结构中的唯一限定标识符
            - PerformDataBinding：将指定数据源绑定到控件
            - PerformSelect：将关联数据源检索广告数据
            - Render：在客户端上显示控件
        - 事件
            - OnAdCreated事件：每次产生新的广告内容时便触发该事件
            - OnPreRender事件：通过查找文件数据或调用用户事件获取要呈现的广告信息
        - XML定义广告体
            - ImageUrl：要显示图像的URL
            - NavigateUrl：单击控件时要跳转的Url
            - AlternateText：图像不可用时显示的文本
            - KeyWord：可用于筛选特定广告的广告类别
            - Impressions：一个指定广告的可能显示频率的数值
            - Height：广告的高度
            - Width：广告的高度
            - 开始结束标记：`<Advertisements></Advertisements>`
            - 一条广告的界限：`<Ad></Ad>`
            - 未定义的元素将传递给AdCreated事件
